{"name":"Coreorm","tagline":"The CoreORM framework","body":"CoreORM/Framework\r\n=================\r\n\r\n### What is this thing?\r\n\r\nWriting data layer is boring, trying to remember all the table names and all the fields in the table is impossible, writing SQL queries is painful and it's so easy to make mistakes!\r\n\r\nI'm sure we've all been through this and we probably trying to avoid this as much as we can, yeah I know there a loads of active-record type ORM layers out there for php to use, but really can you remember all the fields? ```$user->find('user_id=123')``` really?!! And ```echo $user->name``` serious? I have to remember all the fields?\r\n\r\nNope, no, definitely not. So here I am introducing the simplified, light-weight and easy to use (well, code-autocompletion anyone?) ORM framework that totally does not suck.\r\n\r\n### features\r\n1. Thin models that can be used across different types of data source (MySQL/SQlite, will expand to cover more later)\r\n2. DAO (Data Access Objects) that manages the thin models instead of models carrying the connections.\r\n3. Out-of-the-box slave database support for large enterprise level data managements, supported by super simple APIs ```$dao->readModel(\\CoreORM\\Model $model, $useSlave = true)```\r\n4. Table relations in database mapped as object relations! ```$passwordHash = $user->relationGetLogin()->getPassword();```\r\n5. Zero SQL necessary! DAOs will automagically compose the SQL (and trust me, it's very fast) using the relations and criteria from the models.\r\n6. Zero code necessary for models! They are actually generated based on a very simple configuration file (more details see the sections below).\r\n7. Awesome performance - since the models are generated with all table/field information stored within the model, there's no need to describe table to generate queries or whatnot.\r\n8. Extensibility - all models are crafted following proper OOD patterns, it's super easy to extend any model to add functionalities (having said that, you really don't need to do this at 90% of the time).\r\n9. Less code, more accuracy (or actually it's 100% accuracy there). Since all tables are presented by models that contain proper getters and setters, you really don't need to remember the field name/table name at all, just type ```$model->get``` and your IDE should just give you a list of options to pick from.\r\n10. You really want to write your own queries still? That's fine too, add your own DAO extending the base DAO, and you are set!\r\n\r\n### compatibility\r\nThe current version of CoreORM supports the following 2 database systems\r\n* MySQL\r\n* SQLite\r\nFuture versions will add PostgreSQL and MS SQL server, etc.\r\n\r\nThe current version also ships with out of the box Laravel & Slim framework compatibility.\r\n\r\nFor Laravel, since it contains db config already, simply add the following line in your ```boostrap/start.php```, right before the final line ```return $app```, add the following line:\r\n```\r\n\\CoreORM\\Core::integrateWithLaravel();\r\n```\r\nThat's it!\r\n\r\nFor Slim framework, since database config is not part of the framework, you will have to add the database config in the following format before calling your Slim app:\r\n```\r\n$config = array(\r\n    'coreorm' => array(\r\n        'default_database' => 'example',\r\n        'database' => array(\r\n          'example' => array(\r\n              'dbname' => 'coreorm_examples',\r\n              'adaptor' => \\CoreORM\\Adaptor\\Pdo::ADAPTOR_MYSQL,\r\n              'user' => 'coreorm',\r\n              'pass' => 'example',\r\n              'host' => '127.0.0.1'\r\n          )\r\n        )\r\n);\r\n$app = new Slim($config);\r\n```\r\nThen right after that, ad the following line:\r\n```\r\n\\CoreORM\\Core::integrateWithSlim($app);\r\n```\r\nAnd you are set!\r\n\r\n### How to include this package in your project\r\nSimple add the following into your composer.json\r\n\r\n```\r\n    \"require\": {\r\n            \"coreorm/framework\": \"*\"\r\n    },\r\n    \"autoload\": {\r\n        \"files\": [\r\n            \"vendor/coreorm/framework/src/Core.php\"\r\n        ]\r\n    }\r\n```\r\n\r\n\r\n### Install dependencies\r\n\r\n```\r\nrun\r\n    composer install --prefer-dist\r\n```\r\n\r\n\r\n### NOTE: run composer install to enable autoload, if not all files are loading, run\r\n    composer dump-autoload\r\n\r\n### unit tests:\r\nmake sure you do\r\n    chmod +x tests/phpunit so it can run tests\r\n\r\nalso, run the following sql in local (127.0.0.1) mysql instance to test adaptors\r\n\r\n```\r\n    CREATE DATABASE `coreorm` CHARACTER SET utf8;\r\n    USE `coreorm`;\r\n    GRANT all ON `coreorm`.* TO core@localhost IDENTIFIED BY 'test';\r\n\r\n# also add a slave user for it so we can simulate slave test\r\n\r\n    GRANT select ON `coreorm`.* TO core_slave@localhost IDENTIFIED BY 'test';\r\n\r\n# to test sqlite, make sure you do the following:\r\n    // under tests/support folder, run\r\n    mkdir tmp;chmod 775 tmp;\r\n```\r\n\r\n### setup the config this way (runtime).\r\n\r\n```\r\n    setDbConfig('default_database', [default db adaptor name]);  // we need a default always\r\n    // or, alternatively, use\r\n    setDefaultDb([default db adaptor name]);\r\n    // next, set up the database adaptors in this way:\r\n    setDbConfig('database', array(\r\n        [adaptor name] => (array) [$options]\r\n    ));\r\n    // use mysql as an example:\r\n    setDbConfig('database', array(\r\n        'main' => array(\r\n            'dbname' => 'my_db_name',\r\n            'user' => 'db_user_name',\r\n            'pass' => 'db_password',\r\n            'host' => '127.0.0.1',\r\n            'port' => 3306, // optional\r\n            'cache' => false, // default is false, true to enable cache in memory - NOTE: will increase memory usage\r\n        ),\r\n        'db1' => array(\r\n            ...\r\n        ),\r\n    ));\r\n```\r\n\r\n### generating models\r\nRun the following commands at project root\r\n\r\n```\r\n    chmod +x modeller\r\n```\r\n\r\nto generate model, make sure you put a config.php file somewhere, see example below:\r\n\r\n```\r\n    <?php\r\n    $dir = realpath(__DIR__ . '/Model/');\r\n    return array(\r\n        'database' => array(\r\n            'dbname' => 'model_test',\r\n            'user' => 'model',\r\n            'adaptor' => 'MySQL',\r\n            'pass' => 'test',\r\n            'host' => '127.0.0.1'\r\n        ),\r\n        'path' => $dir,\r\n        'namespace' => 'Example\\\\Model',\r\n        'model' => array(\r\n            'user' => array(\r\n                'relations' => [\r\n                    array(\r\n                        'table' => 'login',\r\n                        'join' => 'INNER',\r\n                        'type' => 'S',\r\n                        'on' => array(\r\n                            // support multiple on conditions\r\n                            // must be from left => right\r\n                            'id' => 'user_id'\r\n                        ),\r\n                        'condition' => ''\r\n                    ),\r\n                    array(\r\n                        'table' => 'attachment',\r\n                        'join' => 'LEFT',\r\n                        'type' => 'M',\r\n                        'on' => array(\r\n                            'id' => 'user_id'\r\n                        ),\r\n                        'condition' => ''\r\n                    )\r\n                ],\r\n            ),\r\n            'login' => array(\r\n            ),\r\n            'attachment' => array(\r\n                'class' => 'File'   // let's use a different name for the class...\r\n            ),\r\n        )\r\n    );\r\n```\r\ncopy\r\n```vendor/coreorm/framework/modeller``` to your project root (same level as vendor directory) as it requires autoload.php\r\nfrom under the vendor/ directory (or, alternatively, if you would like to keep it somewhere else, just open it and ensure\r\nthe autoload.php path is correct.\r\n\r\nthen just run\r\n\r\n```\r\n    ./modeller config.php\r\n```\r\n\r\nall the models will be generated in the directory you specified in the configuration file.\r\n\r\n### Summary of common APIs\r\n* Orm::writeModel(Model $model)\r\n```\r\n$Orm = new Orm();\r\n$model = new User();\r\n$model->setName('John Doe')->setAddress('1 Sydney Rd. Sydney, NSW 2000, Australia);\r\n$Orm->writeModel($model);\r\n```\r\n* Orm::readModel(Model $model, $useSlave = false)\r\n```\r\n$Orm = new Orm();\r\n$model = new User();\r\n$model->setId(123);\r\n$Orm->readModel($model);\r\necho $model->getName();\r\n```\r\n* Orm::readModels(Model $model, $condition = array(), $bind = array(), $orderBy = array(), $limit = null, $useSlave = false)\r\n```\r\n$Orm = new Orm();\r\n$model = new User();\r\n$models = $Orm->writeModels($model, array(User::Field_NAME . \" LIKE '%Jo%'\"));\r\nforeach ($models as $user) {\r\n    echo $user->getName();\r\n}\r\n```\r\n* Orm::deleteModel(Model $model)\r\n```\r\n$Orm = new Orm();\r\n$model = new User();\r\n$model->setId(123);\r\n$Orm->deleteModel($model);\r\n```\r\n\r\n### Examples:\r\n\r\nFor examples, visit the [CoreORM\\Examples](https://github.com/coreorm/example)\r\n","google":"UA-54007203-1","note":"Don't delete this file! It's used internally to help with page regeneration."}