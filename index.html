<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Coreorm by coreorm</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Coreorm</h1>
          <h2>The CoreORM framework</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/coreorm/coreorm/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/coreorm/coreorm/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/coreorm/coreorm" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="coreormframework" class="anchor" href="#coreormframework"><span class="octicon octicon-link"></span></a>CoreORM/Framework</h1>

<h3>
<a name="what-is-this-thing" class="anchor" href="#what-is-this-thing"><span class="octicon octicon-link"></span></a>What is this thing?</h3>

<p>Writing data layer is boring, trying to remember all the table names and all the fields in the table is impossible, writing SQL queries is painful and it's so easy to make mistakes!</p>

<p>I'm sure we've all been through this and we probably trying to avoid this as much as we can, yeah I know there a loads of active-record type ORM layers out there for php to use, but really can you remember all the fields? <code>$user-&gt;find('user_id=123')</code> really?!! And <code>echo $user-&gt;name</code> serious? I have to remember all the fields?</p>

<p>Nope, no, definitely not. So here I am introducing the simplified, light-weight and easy to use (well, code-autocompletion anyone?) ORM framework that totally does not suck.</p>

<h3>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>features</h3>

<ol>
<li>Thin models that can be used across different types of data source (MySQL/SQlite, will expand to cover more later)</li>
<li>DAO (Data Access Objects) that manages the thin models instead of models carrying the connections.</li>
<li>Out-of-the-box slave database support for large enterprise level data managements, supported by super simple APIs <code>$dao-&gt;readModel(\CoreORM\Model $model, $useSlave = true)</code>
</li>
<li>Table relations in database mapped as object relations! <code>$passwordHash = $user-&gt;relationGetLogin()-&gt;getPassword();</code>
</li>
<li>Zero SQL necessary! DAOs will automagically compose the SQL (and trust me, it's very fast) using the relations and criteria from the models.</li>
<li>Zero code necessary for models! They are actually generated based on a very simple configuration file (more details see the sections below).</li>
<li>Awesome performance - since the models are generated with all table/field information stored within the model, there's no need to describe table to generate queries or whatnot.</li>
<li>Extensibility - all models are crafted following proper OOD patterns, it's super easy to extend any model to add functionalities (having said that, you really don't need to do this at 90% of the time).</li>
<li>Less code, more accuracy (or actually it's 100% accuracy there). Since all tables are presented by models that contain proper getters and setters, you really don't need to remember the field name/table name at all, just type <code>$model-&gt;get</code> and your IDE should just give you a list of options to pick from.</li>
<li>You really want to write your own queries still? That's fine too, add your own DAO extending the base DAO, and you are set!</li>
</ol><h3>
<a name="how-to-include-this-package-in-your-project" class="anchor" href="#how-to-include-this-package-in-your-project"><span class="octicon octicon-link"></span></a>How to include this package in your project</h3>

<p>Simple add the following into your composer.json</p>

<pre><code>    "require": {
            "coreorm/framework": "*"
    },
    "autoload": {
        "files": [
            "vendor/coreorm/framework/src/Core.php"
        ]
    }
</code></pre>

<h3>
<a name="install-dependencies" class="anchor" href="#install-dependencies"><span class="octicon octicon-link"></span></a>Install dependencies</h3>

<pre><code>run
    composer install --prefer-dist
</code></pre>

<h3>
<a name="note-run-composer-install-to-enable-autoload-if-not-all-files-are-loading-run" class="anchor" href="#note-run-composer-install-to-enable-autoload-if-not-all-files-are-loading-run"><span class="octicon octicon-link"></span></a>NOTE: run composer install to enable autoload, if not all files are loading, run</h3>

<pre><code>composer dump-autoload
</code></pre>

<h3>
<a name="unit-tests" class="anchor" href="#unit-tests"><span class="octicon octicon-link"></span></a>unit tests:</h3>

<p>make sure you do
    chmod +x tests/phpunit so it can run tests</p>

<p>also, run the following sql in local (127.0.0.1) mysql instance to test adaptors</p>

<pre><code>    CREATE DATABASE `coreorm` CHARACTER SET utf8;
    USE `coreorm`;
    GRANT all ON `coreorm`.* TO core@localhost IDENTIFIED BY 'test';

# also add a slave user for it so we can simulate slave test

    GRANT select ON `coreorm`.* TO core_slave@localhost IDENTIFIED BY 'test';

# to test sqlite, make sure you do the following:
    // under tests/support folder, run
    mkdir tmp;chmod 775 tmp;
</code></pre>

<h3>
<a name="setup-the-config-this-way-runtime" class="anchor" href="#setup-the-config-this-way-runtime"><span class="octicon octicon-link"></span></a>setup the config this way (runtime).</h3>

<pre><code>    setDbConfig('default_database', [default db adaptor name]);  // we need a default always
    // next, set up the database adaptors in this way:
    setDbConfig('database', array(
        [adaptor name] =&gt; (array) [$options]
    ));
    // use mysql as an example:
    setDbConfig('database', array(
        'main' =&gt; array(
            'dbname' =&gt; 'my_db_name',
            'user' =&gt; 'db_user_name',
            'pass' =&gt; 'db_password',
            'host' =&gt; '127.0.0.1',
            'port' =&gt; 3306, // optional
            'cache' =&gt; false, // default is false, true to enable cache in memory - NOTE: will increase memory usage
        ),
        'db1' =&gt; array(
            ...
        ),
    ));
</code></pre>

<h3>
<a name="generating-models" class="anchor" href="#generating-models"><span class="octicon octicon-link"></span></a>generating models</h3>

<p>Run the following commands at project root</p>

<pre><code>    chmod +x modeller
</code></pre>

<p>to generate model, make sure you put a config.php file somewhere, see example below:</p>

<pre><code>    &lt;?php
    $dir = realpath(__DIR__ . '/Model/');
    return array(
        'database' =&gt; array(
            'dbname' =&gt; 'model_test',
            'user' =&gt; 'model',
            'adaptor' =&gt; 'MySQL',
            'pass' =&gt; 'test',
            'host' =&gt; '127.0.0.1'
        ),
        'path' =&gt; $dir,
        'namespace' =&gt; 'Example\\Model',
        'model' =&gt; array(
            'user' =&gt; array(
                'relations' =&gt; [
                    array(
                        'table' =&gt; 'login',
                        'join' =&gt; 'INNER',
                        'type' =&gt; 'S',
                        'on' =&gt; array(
                            // support multiple on conditions
                            // must be from left =&gt; right
                            'id' =&gt; 'user_id'
                        ),
                        'condition' =&gt; ''
                    ),
                    array(
                        'table' =&gt; 'attachment',
                        'join' =&gt; 'LEFT',
                        'type' =&gt; 'M',
                        'on' =&gt; array(
                            'id' =&gt; 'user_id'
                        ),
                        'condition' =&gt; ''
                    )
                ],
            ),
            'login' =&gt; array(
            ),
            'attachment' =&gt; array(
                'class' =&gt; 'File'   // let's use a different name for the class...
            ),
        )
    );
</code></pre>

<p>copy
<code>vendor/coreorm/framework/modeller</code> to your project root (same level as vendor directory) as it requires autoload.php
from under the vendor/ directory (or, alternatively, if you would like to keep it somewhere else, just open it and ensure
the autoload.php path is correct.</p>

<p>then just run</p>

<pre><code>    ./modeller config.php
</code></pre>

<p>all the models will be generated in the directory you specified in the configuration file.</p>

<h3>
<a name="summary-of-common-apis" class="anchor" href="#summary-of-common-apis"><span class="octicon octicon-link"></span></a>Summary of common APIs</h3>

<ul>
<li>Orm::writeModel(Model $model)</li>
</ul><pre><code>$Orm = new Orm();
$model = new User();
$model-&gt;setName('John Doe')-&gt;setAddress('1 Sydney Rd. Sydney, NSW 2000, Australia);
$Orm-&gt;writeModel($model);
</code></pre>

<ul>
<li>Orm::readModel(Model $model, $useSlave = false)</li>
</ul><pre><code>$Orm = new Orm();
$model = new User();
$model-&gt;setId(123);
$Orm-&gt;readModel($model);
echo $model-&gt;getName();
</code></pre>

<ul>
<li>Orm::readModels(Model $model, $condition = array(), $bind = array(), $orderBy = array(), $limit = null, $useSlave = false)</li>
</ul><pre><code>$Orm = new Orm();
$model = new User();
$models = $Orm-&gt;writeModels($model, array(User::Field_NAME . " LIKE '%Jo%'"));
foreach ($models as $user) {
    echo $user-&gt;getName();
}
</code></pre>

<ul>
<li>Orm::deleteModel(Model $model)</li>
</ul><pre><code>$Orm = new Orm();
$model = new User();
$model-&gt;setId(123);
$Orm-&gt;deleteModel($model);
</code></pre>

<h3>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples:</h3>

<p>For examples, visit the <a href="https://github.com/coreorm/example">CoreORM\Examples</a></p>
        </section>

        <footer>
          Coreorm is maintained by <a href="https://github.com/coreorm">coreorm</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-54007203-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>